On WorkerInfo(id=1, name=worker1):
ValueError('Expected more than 1 value per channel when training, got input size torch.Size([1, 512, 1, 1])')
Traceback (most recent call last):
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/internal.py", line 204, in _run_function
    result = python_udf.func(*python_udf.args, **python_udf.kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/rref_proxy.py", line 9, in _local_invoke
    return getattr(rref.local_value(), func_name)(*args, **kwargs)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 156, in forward
    x1 = self.make_layer2(x1)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torchvision/models/resnet.py", line 129, in forward
    out = self.bn2(out)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/batchnorm.py", line 179, in forward
    self.eps,
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/functional.py", line 2280, in batch_norm
    _verify_batch_size(input.size())
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/functional.py", line 2248, in _verify_batch_size
    raise ValueError("Expected more than 1 value per channel when training, got input size {}".format(size))
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 512, 1, 1])

On WorkerInfo(id=1, name=worker1):
ValueError('Expected more than 1 value per channel when training, got input size torch.Size([1, 512, 1, 1])')
Traceback (most recent call last):
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/internal.py", line 204, in _run_function
    result = python_udf.func(*python_udf.args, **python_udf.kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/rref_proxy.py", line 9, in _local_invoke
    return getattr(rref.local_value(), func_name)(*args, **kwargs)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 156, in forward
    x1 = self.make_layer2(x1)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torchvision/models/resnet.py", line 129, in forward
    out = self.bn2(out)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/batchnorm.py", line 179, in forward
    self.eps,
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/functional.py", line 2280, in batch_norm
    _verify_batch_size(input.size())
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/functional.py", line 2248, in _verify_batch_size
    raise ValueError("Expected more than 1 value per channel when training, got input size {}".format(size))
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 512, 1, 1])

On WorkerInfo(id=1, name=worker1):
RuntimeError("Couldn't find autograd context data for current autograd context id\nException raised from currentContext at /opt/conda/conda-bld/pytorch_1639180594101/work/torch/csrc/distributed/autograd/context/container.cpp:178 (most recent call first):\nframe #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff7f11b1d62 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7ff7f11ae75f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #2: torch::distributed::autograd::DistAutogradContainer::currentContext() + 0x16f (0x7ff83a6158df in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #3: torch::distributed::autograd::getMessageWithAutograd(short, c10::intrusive_ptr<torch::distributed::rpc::Message, c10::detail::intrusive_target_default_null_type<torch::distributed::rpc::Message> >, torch::distributed::rpc::MessageType, bool, std::unordered_map<c10::Device, c10::Device, std::hash<c10::Device>, std::equal_to<c10::Device>, std::allocator<std::pair<c10::Device const, c10::Device> > > const&) + 0xf2 (0x7ff83a612742 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #4: <unknown function> + 0x3d465be (0x7ff83a6495be in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #5: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #6: <unknown function> + 0xb56f39 (0x7ff88af93f39 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #7: <unknown function> + 0xef8c0f (0x7ff88b335c0f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #8: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #9: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #10: <unknown function> + 0x3d45f2c (0x7ff83a648f2c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #11: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #12: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #13: torch::distributed::rpc::OwnerRRef::setValue(c10::IValue&&) + 0x34 (0x7ff83a662374 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #14: <unknown function> + 0x3d459b5 (0x7ff83a6489b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #15: torch::distributed::rpc::RequestCallbackNoPython::assignOwnerRRef(torch::distributed::rpc::GloballyUniqueId const&, torch::distributed::rpc::GloballyUniqueId const&, c10::intrusive_ptr<c10::ivalue::Future, c10::detail::intrusive_target_default_null_type<c10::ivalue::Future> >) const + 0x494 (0x7ff83a64cd24 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #16: torch::distributed::rpc::RequestCallbackImpl::processPythonRemoteCall(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0xbc (0x7ff88b331c7c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #17: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x17f (0x7ff83a650c1f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #18: torch::distributed::rpc::RequestCallbackNoPython::processForwardAutogradReq(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x1b0 (0x7ff83a651090 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #19: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x213 (0x7ff83a650cb3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #20: torch::distributed::rpc::RequestCallbackImpl::processRpcWithErrors(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x55 (0x7ff88b3313b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #21: <unknown function> + 0x3d479cb (0x7ff83a64a9cb in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #22: torch::distributed::rpc::RequestCallbackNoPython::processMessage(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x4a4 (0x7ff83a64b504 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #23: torch::distributed::rpc::RequestCallback::operator()(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x47 (0x7ff83a6469d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #24: <unknown function> + 0x3d778d7 (0x7ff83a67a8d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #25: c10::ThreadPool::main_loop(unsigned long) + 0x283 (0x7ff7f11a29b3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #26: <unknown function> + 0xc9039 (0x7ff8b8a91039 in /home/junchen/miniconda3/lib/python3.7/site-packages/google/protobuf/pyext/../../../../../libstdc++.so.6)\nframe #27: <unknown function> + 0x8609 (0x7ff8c86e9609 in /lib/x86_64-linux-gnu/libpthread.so.0)\nframe #28: clone + 0x43 (0x7ff8c860e163 in /lib/x86_64-linux-gnu/libc.so.6)\n")
Traceback (most recent call last):
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/internal.py", line 204, in _run_function
    result = python_udf.func(*python_udf.args, **python_udf.kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/rref_proxy.py", line 9, in _local_invoke
    return getattr(rref.local_value(), func_name)(*args, **kwargs)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 151, in forward
    x1 = x_rref.to_here().to(self.device)
RuntimeError: Couldn't find autograd context data for current autograd context id
Exception raised from currentContext at /opt/conda/conda-bld/pytorch_1639180594101/work/torch/csrc/distributed/autograd/context/container.cpp:178 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff7f11b1d62 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7ff7f11ae75f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #2: torch::distributed::autograd::DistAutogradContainer::currentContext() + 0x16f (0x7ff83a6158df in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #3: torch::distributed::autograd::getMessageWithAutograd(short, c10::intrusive_ptr<torch::distributed::rpc::Message, c10::detail::intrusive_target_default_null_type<torch::distributed::rpc::Message> >, torch::distributed::rpc::MessageType, bool, std::unordered_map<c10::Device, c10::Device, std::hash<c10::Device>, std::equal_to<c10::Device>, std::allocator<std::pair<c10::Device const, c10::Device> > > const&) + 0xf2 (0x7ff83a612742 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x3d465be (0x7ff83a6495be in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #5: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #6: <unknown function> + 0xb56f39 (0x7ff88af93f39 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0xef8c0f (0x7ff88b335c0f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #8: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #9: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #10: <unknown function> + 0x3d45f2c (0x7ff83a648f2c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #11: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #12: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #13: torch::distributed::rpc::OwnerRRef::setValue(c10::IValue&&) + 0x34 (0x7ff83a662374 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x3d459b5 (0x7ff83a6489b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #15: torch::distributed::rpc::RequestCallbackNoPython::assignOwnerRRef(torch::distributed::rpc::GloballyUniqueId const&, torch::distributed::rpc::GloballyUniqueId const&, c10::intrusive_ptr<c10::ivalue::Future, c10::detail::intrusive_target_default_null_type<c10::ivalue::Future> >) const + 0x494 (0x7ff83a64cd24 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #16: torch::distributed::rpc::RequestCallbackImpl::processPythonRemoteCall(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0xbc (0x7ff88b331c7c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #17: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x17f (0x7ff83a650c1f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #18: torch::distributed::rpc::RequestCallbackNoPython::processForwardAutogradReq(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x1b0 (0x7ff83a651090 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #19: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x213 (0x7ff83a650cb3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #20: torch::distributed::rpc::RequestCallbackImpl::processRpcWithErrors(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x55 (0x7ff88b3313b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #21: <unknown function> + 0x3d479cb (0x7ff83a64a9cb in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #22: torch::distributed::rpc::RequestCallbackNoPython::processMessage(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x4a4 (0x7ff83a64b504 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #23: torch::distributed::rpc::RequestCallback::operator()(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x47 (0x7ff83a6469d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x3d778d7 (0x7ff83a67a8d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #25: c10::ThreadPool::main_loop(unsigned long) + 0x283 (0x7ff7f11a29b3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #26: <unknown function> + 0xc9039 (0x7ff8b8a91039 in /home/junchen/miniconda3/lib/python3.7/site-packages/google/protobuf/pyext/../../../../../libstdc++.so.6)
frame #27: <unknown function> + 0x8609 (0x7ff8c86e9609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #28: clone + 0x43 (0x7ff8c860e163 in /lib/x86_64-linux-gnu/libc.so.6)


On WorkerInfo(id=1, name=worker1):
RuntimeError("Couldn't find autograd context data for current autograd context id\nException raised from currentContext at /opt/conda/conda-bld/pytorch_1639180594101/work/torch/csrc/distributed/autograd/context/container.cpp:178 (most recent call first):\nframe #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff7f11b1d62 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7ff7f11ae75f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #2: torch::distributed::autograd::DistAutogradContainer::currentContext() + 0x16f (0x7ff83a6158df in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #3: torch::distributed::autograd::getMessageWithAutograd(short, c10::intrusive_ptr<torch::distributed::rpc::Message, c10::detail::intrusive_target_default_null_type<torch::distributed::rpc::Message> >, torch::distributed::rpc::MessageType, bool, std::unordered_map<c10::Device, c10::Device, std::hash<c10::Device>, std::equal_to<c10::Device>, std::allocator<std::pair<c10::Device const, c10::Device> > > const&) + 0xf2 (0x7ff83a612742 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #4: <unknown function> + 0x3d465be (0x7ff83a6495be in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #5: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #6: <unknown function> + 0xb56f39 (0x7ff88af93f39 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #7: <unknown function> + 0xef8c0f (0x7ff88b335c0f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #8: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #9: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #10: <unknown function> + 0x3d45f2c (0x7ff83a648f2c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #11: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #12: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #13: torch::distributed::rpc::OwnerRRef::setValue(c10::IValue&&) + 0x34 (0x7ff83a662374 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #14: <unknown function> + 0x3d459b5 (0x7ff83a6489b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #15: torch::distributed::rpc::RequestCallbackNoPython::assignOwnerRRef(torch::distributed::rpc::GloballyUniqueId const&, torch::distributed::rpc::GloballyUniqueId const&, c10::intrusive_ptr<c10::ivalue::Future, c10::detail::intrusive_target_default_null_type<c10::ivalue::Future> >) const + 0x494 (0x7ff83a64cd24 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #16: torch::distributed::rpc::RequestCallbackImpl::processPythonRemoteCall(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0xbc (0x7ff88b331c7c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #17: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x17f (0x7ff83a650c1f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #18: torch::distributed::rpc::RequestCallbackNoPython::processForwardAutogradReq(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x1b0 (0x7ff83a651090 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #19: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x213 (0x7ff83a650cb3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #20: torch::distributed::rpc::RequestCallbackImpl::processRpcWithErrors(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x55 (0x7ff88b3313b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #21: <unknown function> + 0x3d479cb (0x7ff83a64a9cb in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #22: torch::distributed::rpc::RequestCallbackNoPython::processMessage(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x4a4 (0x7ff83a64b504 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #23: torch::distributed::rpc::RequestCallback::operator()(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x47 (0x7ff83a6469d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #24: <unknown function> + 0x3d778d7 (0x7ff83a67a8d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #25: c10::ThreadPool::main_loop(unsigned long) + 0x283 (0x7ff7f11a29b3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #26: <unknown function> + 0xc9039 (0x7ff8b8a91039 in /home/junchen/miniconda3/lib/python3.7/site-packages/google/protobuf/pyext/../../../../../libstdc++.so.6)\nframe #27: <unknown function> + 0x8609 (0x7ff8c86e9609 in /lib/x86_64-linux-gnu/libpthread.so.0)\nframe #28: clone + 0x43 (0x7ff8c860e163 in /lib/x86_64-linux-gnu/libc.so.6)\n")
Traceback (most recent call last):
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/internal.py", line 204, in _run_function
    result = python_udf.func(*python_udf.args, **python_udf.kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/rref_proxy.py", line 9, in _local_invoke
    return getattr(rref.local_value(), func_name)(*args, **kwargs)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 151, in forward
    x1 = x_rref.to_here().to(self.device)
RuntimeError: Couldn't find autograd context data for current autograd context id
Exception raised from currentContext at /opt/conda/conda-bld/pytorch_1639180594101/work/torch/csrc/distributed/autograd/context/container.cpp:178 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff7f11b1d62 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7ff7f11ae75f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #2: torch::distributed::autograd::DistAutogradContainer::currentContext() + 0x16f (0x7ff83a6158df in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #3: torch::distributed::autograd::getMessageWithAutograd(short, c10::intrusive_ptr<torch::distributed::rpc::Message, c10::detail::intrusive_target_default_null_type<torch::distributed::rpc::Message> >, torch::distributed::rpc::MessageType, bool, std::unordered_map<c10::Device, c10::Device, std::hash<c10::Device>, std::equal_to<c10::Device>, std::allocator<std::pair<c10::Device const, c10::Device> > > const&) + 0xf2 (0x7ff83a612742 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x3d465be (0x7ff83a6495be in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #5: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #6: <unknown function> + 0xb56f39 (0x7ff88af93f39 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0xef8c0f (0x7ff88b335c0f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #8: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #9: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #10: <unknown function> + 0x3d45f2c (0x7ff83a648f2c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #11: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #12: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #13: torch::distributed::rpc::OwnerRRef::setValue(c10::IValue&&) + 0x34 (0x7ff83a662374 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x3d459b5 (0x7ff83a6489b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #15: torch::distributed::rpc::RequestCallbackNoPython::assignOwnerRRef(torch::distributed::rpc::GloballyUniqueId const&, torch::distributed::rpc::GloballyUniqueId const&, c10::intrusive_ptr<c10::ivalue::Future, c10::detail::intrusive_target_default_null_type<c10::ivalue::Future> >) const + 0x494 (0x7ff83a64cd24 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #16: torch::distributed::rpc::RequestCallbackImpl::processPythonRemoteCall(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0xbc (0x7ff88b331c7c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #17: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x17f (0x7ff83a650c1f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #18: torch::distributed::rpc::RequestCallbackNoPython::processForwardAutogradReq(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x1b0 (0x7ff83a651090 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #19: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x213 (0x7ff83a650cb3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #20: torch::distributed::rpc::RequestCallbackImpl::processRpcWithErrors(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x55 (0x7ff88b3313b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #21: <unknown function> + 0x3d479cb (0x7ff83a64a9cb in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #22: torch::distributed::rpc::RequestCallbackNoPython::processMessage(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x4a4 (0x7ff83a64b504 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #23: torch::distributed::rpc::RequestCallback::operator()(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x47 (0x7ff83a6469d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x3d778d7 (0x7ff83a67a8d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #25: c10::ThreadPool::main_loop(unsigned long) + 0x283 (0x7ff7f11a29b3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #26: <unknown function> + 0xc9039 (0x7ff8b8a91039 in /home/junchen/miniconda3/lib/python3.7/site-packages/google/protobuf/pyext/../../../../../libstdc++.so.6)
frame #27: <unknown function> + 0x8609 (0x7ff8c86e9609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #28: clone + 0x43 (0x7ff8c860e163 in /lib/x86_64-linux-gnu/libc.so.6)


On WorkerInfo(id=1, name=worker1):
RuntimeError("Couldn't find autograd context data for current autograd context id\nException raised from currentContext at /opt/conda/conda-bld/pytorch_1639180594101/work/torch/csrc/distributed/autograd/context/container.cpp:178 (most recent call first):\nframe #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff7f11b1d62 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7ff7f11ae75f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #2: torch::distributed::autograd::DistAutogradContainer::currentContext() + 0x16f (0x7ff83a6158df in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #3: torch::distributed::autograd::getMessageWithAutograd(short, c10::intrusive_ptr<torch::distributed::rpc::Message, c10::detail::intrusive_target_default_null_type<torch::distributed::rpc::Message> >, torch::distributed::rpc::MessageType, bool, std::unordered_map<c10::Device, c10::Device, std::hash<c10::Device>, std::equal_to<c10::Device>, std::allocator<std::pair<c10::Device const, c10::Device> > > const&) + 0xf2 (0x7ff83a612742 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #4: <unknown function> + 0x3d465be (0x7ff83a6495be in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #5: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #6: <unknown function> + 0xb56f39 (0x7ff88af93f39 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #7: <unknown function> + 0xef8c0f (0x7ff88b335c0f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #8: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #9: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #10: <unknown function> + 0x3d45f2c (0x7ff83a648f2c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #11: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #12: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #13: torch::distributed::rpc::OwnerRRef::setValue(c10::IValue&&) + 0x34 (0x7ff83a662374 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #14: <unknown function> + 0x3d459b5 (0x7ff83a6489b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #15: torch::distributed::rpc::RequestCallbackNoPython::assignOwnerRRef(torch::distributed::rpc::GloballyUniqueId const&, torch::distributed::rpc::GloballyUniqueId const&, c10::intrusive_ptr<c10::ivalue::Future, c10::detail::intrusive_target_default_null_type<c10::ivalue::Future> >) const + 0x494 (0x7ff83a64cd24 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #16: torch::distributed::rpc::RequestCallbackImpl::processPythonRemoteCall(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0xbc (0x7ff88b331c7c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #17: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x17f (0x7ff83a650c1f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #18: torch::distributed::rpc::RequestCallbackNoPython::processForwardAutogradReq(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x1b0 (0x7ff83a651090 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #19: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x213 (0x7ff83a650cb3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #20: torch::distributed::rpc::RequestCallbackImpl::processRpcWithErrors(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x55 (0x7ff88b3313b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #21: <unknown function> + 0x3d479cb (0x7ff83a64a9cb in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #22: torch::distributed::rpc::RequestCallbackNoPython::processMessage(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x4a4 (0x7ff83a64b504 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #23: torch::distributed::rpc::RequestCallback::operator()(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x47 (0x7ff83a6469d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #24: <unknown function> + 0x3d778d7 (0x7ff83a67a8d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #25: c10::ThreadPool::main_loop(unsigned long) + 0x283 (0x7ff7f11a29b3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #26: <unknown function> + 0xc9039 (0x7ff8b8a91039 in /home/junchen/miniconda3/lib/python3.7/site-packages/google/protobuf/pyext/../../../../../libstdc++.so.6)\nframe #27: <unknown function> + 0x8609 (0x7ff8c86e9609 in /lib/x86_64-linux-gnu/libpthread.so.0)\nframe #28: clone + 0x43 (0x7ff8c860e163 in /lib/x86_64-linux-gnu/libc.so.6)\n")
Traceback (most recent call last):
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/internal.py", line 204, in _run_function
    result = python_udf.func(*python_udf.args, **python_udf.kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/rref_proxy.py", line 9, in _local_invoke
    return getattr(rref.local_value(), func_name)(*args, **kwargs)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 151, in forward
    x1 = x_rref.to_here().to(self.device)
RuntimeError: Couldn't find autograd context data for current autograd context id
Exception raised from currentContext at /opt/conda/conda-bld/pytorch_1639180594101/work/torch/csrc/distributed/autograd/context/container.cpp:178 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff7f11b1d62 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7ff7f11ae75f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #2: torch::distributed::autograd::DistAutogradContainer::currentContext() + 0x16f (0x7ff83a6158df in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #3: torch::distributed::autograd::getMessageWithAutograd(short, c10::intrusive_ptr<torch::distributed::rpc::Message, c10::detail::intrusive_target_default_null_type<torch::distributed::rpc::Message> >, torch::distributed::rpc::MessageType, bool, std::unordered_map<c10::Device, c10::Device, std::hash<c10::Device>, std::equal_to<c10::Device>, std::allocator<std::pair<c10::Device const, c10::Device> > > const&) + 0xf2 (0x7ff83a612742 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x3d465be (0x7ff83a6495be in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #5: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #6: <unknown function> + 0xb56f39 (0x7ff88af93f39 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0xef8c0f (0x7ff88b335c0f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #8: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #9: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #10: <unknown function> + 0x3d45f2c (0x7ff83a648f2c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #11: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #12: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #13: torch::distributed::rpc::OwnerRRef::setValue(c10::IValue&&) + 0x34 (0x7ff83a662374 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x3d459b5 (0x7ff83a6489b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #15: torch::distributed::rpc::RequestCallbackNoPython::assignOwnerRRef(torch::distributed::rpc::GloballyUniqueId const&, torch::distributed::rpc::GloballyUniqueId const&, c10::intrusive_ptr<c10::ivalue::Future, c10::detail::intrusive_target_default_null_type<c10::ivalue::Future> >) const + 0x494 (0x7ff83a64cd24 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #16: torch::distributed::rpc::RequestCallbackImpl::processPythonRemoteCall(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0xbc (0x7ff88b331c7c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #17: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x17f (0x7ff83a650c1f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #18: torch::distributed::rpc::RequestCallbackNoPython::processForwardAutogradReq(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x1b0 (0x7ff83a651090 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #19: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x213 (0x7ff83a650cb3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #20: torch::distributed::rpc::RequestCallbackImpl::processRpcWithErrors(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x55 (0x7ff88b3313b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #21: <unknown function> + 0x3d479cb (0x7ff83a64a9cb in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #22: torch::distributed::rpc::RequestCallbackNoPython::processMessage(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x4a4 (0x7ff83a64b504 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #23: torch::distributed::rpc::RequestCallback::operator()(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x47 (0x7ff83a6469d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x3d778d7 (0x7ff83a67a8d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #25: c10::ThreadPool::main_loop(unsigned long) + 0x283 (0x7ff7f11a29b3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #26: <unknown function> + 0xc9039 (0x7ff8b8a91039 in /home/junchen/miniconda3/lib/python3.7/site-packages/google/protobuf/pyext/../../../../../libstdc++.so.6)
frame #27: <unknown function> + 0x8609 (0x7ff8c86e9609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #28: clone + 0x43 (0x7ff8c860e163 in /lib/x86_64-linux-gnu/libc.so.6)


On WorkerInfo(id=1, name=worker1):
RuntimeError("Couldn't find autograd context data for current autograd context id\nException raised from currentContext at /opt/conda/conda-bld/pytorch_1639180594101/work/torch/csrc/distributed/autograd/context/container.cpp:178 (most recent call first):\nframe #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff7f11b1d62 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7ff7f11ae75f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #2: torch::distributed::autograd::DistAutogradContainer::currentContext() + 0x16f (0x7ff83a6158df in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #3: torch::distributed::autograd::getMessageWithAutograd(short, c10::intrusive_ptr<torch::distributed::rpc::Message, c10::detail::intrusive_target_default_null_type<torch::distributed::rpc::Message> >, torch::distributed::rpc::MessageType, bool, std::unordered_map<c10::Device, c10::Device, std::hash<c10::Device>, std::equal_to<c10::Device>, std::allocator<std::pair<c10::Device const, c10::Device> > > const&) + 0xf2 (0x7ff83a612742 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #4: <unknown function> + 0x3d465be (0x7ff83a6495be in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #5: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #6: <unknown function> + 0xb56f39 (0x7ff88af93f39 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #7: <unknown function> + 0xef8c0f (0x7ff88b335c0f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #8: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #9: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #10: <unknown function> + 0x3d45f2c (0x7ff83a648f2c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #11: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #12: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #13: torch::distributed::rpc::OwnerRRef::setValue(c10::IValue&&) + 0x34 (0x7ff83a662374 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #14: <unknown function> + 0x3d459b5 (0x7ff83a6489b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #15: torch::distributed::rpc::RequestCallbackNoPython::assignOwnerRRef(torch::distributed::rpc::GloballyUniqueId const&, torch::distributed::rpc::GloballyUniqueId const&, c10::intrusive_ptr<c10::ivalue::Future, c10::detail::intrusive_target_default_null_type<c10::ivalue::Future> >) const + 0x494 (0x7ff83a64cd24 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #16: torch::distributed::rpc::RequestCallbackImpl::processPythonRemoteCall(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0xbc (0x7ff88b331c7c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #17: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x17f (0x7ff83a650c1f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #18: torch::distributed::rpc::RequestCallbackNoPython::processForwardAutogradReq(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x1b0 (0x7ff83a651090 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #19: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x213 (0x7ff83a650cb3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #20: torch::distributed::rpc::RequestCallbackImpl::processRpcWithErrors(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x55 (0x7ff88b3313b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #21: <unknown function> + 0x3d479cb (0x7ff83a64a9cb in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #22: torch::distributed::rpc::RequestCallbackNoPython::processMessage(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x4a4 (0x7ff83a64b504 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #23: torch::distributed::rpc::RequestCallback::operator()(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x47 (0x7ff83a6469d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #24: <unknown function> + 0x3d778d7 (0x7ff83a67a8d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #25: c10::ThreadPool::main_loop(unsigned long) + 0x283 (0x7ff7f11a29b3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #26: <unknown function> + 0xc9039 (0x7ff8b8a91039 in /home/junchen/miniconda3/lib/python3.7/site-packages/google/protobuf/pyext/../../../../../libstdc++.so.6)\nframe #27: <unknown function> + 0x8609 (0x7ff8c86e9609 in /lib/x86_64-linux-gnu/libpthread.so.0)\nframe #28: clone + 0x43 (0x7ff8c860e163 in /lib/x86_64-linux-gnu/libc.so.6)\n")
Traceback (most recent call last):
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/internal.py", line 204, in _run_function
    result = python_udf.func(*python_udf.args, **python_udf.kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/rref_proxy.py", line 9, in _local_invoke
    return getattr(rref.local_value(), func_name)(*args, **kwargs)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 151, in forward
    x1 = x_rref.to_here().to(self.device)
RuntimeError: Couldn't find autograd context data for current autograd context id
Exception raised from currentContext at /opt/conda/conda-bld/pytorch_1639180594101/work/torch/csrc/distributed/autograd/context/container.cpp:178 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff7f11b1d62 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7ff7f11ae75f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #2: torch::distributed::autograd::DistAutogradContainer::currentContext() + 0x16f (0x7ff83a6158df in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #3: torch::distributed::autograd::getMessageWithAutograd(short, c10::intrusive_ptr<torch::distributed::rpc::Message, c10::detail::intrusive_target_default_null_type<torch::distributed::rpc::Message> >, torch::distributed::rpc::MessageType, bool, std::unordered_map<c10::Device, c10::Device, std::hash<c10::Device>, std::equal_to<c10::Device>, std::allocator<std::pair<c10::Device const, c10::Device> > > const&) + 0xf2 (0x7ff83a612742 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x3d465be (0x7ff83a6495be in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #5: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #6: <unknown function> + 0xb56f39 (0x7ff88af93f39 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0xef8c0f (0x7ff88b335c0f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #8: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #9: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #10: <unknown function> + 0x3d45f2c (0x7ff83a648f2c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #11: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #12: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #13: torch::distributed::rpc::OwnerRRef::setValue(c10::IValue&&) + 0x34 (0x7ff83a662374 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x3d459b5 (0x7ff83a6489b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #15: torch::distributed::rpc::RequestCallbackNoPython::assignOwnerRRef(torch::distributed::rpc::GloballyUniqueId const&, torch::distributed::rpc::GloballyUniqueId const&, c10::intrusive_ptr<c10::ivalue::Future, c10::detail::intrusive_target_default_null_type<c10::ivalue::Future> >) const + 0x494 (0x7ff83a64cd24 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #16: torch::distributed::rpc::RequestCallbackImpl::processPythonRemoteCall(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0xbc (0x7ff88b331c7c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #17: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x17f (0x7ff83a650c1f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #18: torch::distributed::rpc::RequestCallbackNoPython::processForwardAutogradReq(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x1b0 (0x7ff83a651090 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #19: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x213 (0x7ff83a650cb3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #20: torch::distributed::rpc::RequestCallbackImpl::processRpcWithErrors(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x55 (0x7ff88b3313b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #21: <unknown function> + 0x3d479cb (0x7ff83a64a9cb in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #22: torch::distributed::rpc::RequestCallbackNoPython::processMessage(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x4a4 (0x7ff83a64b504 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #23: torch::distributed::rpc::RequestCallback::operator()(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x47 (0x7ff83a6469d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x3d778d7 (0x7ff83a67a8d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #25: c10::ThreadPool::main_loop(unsigned long) + 0x283 (0x7ff7f11a29b3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #26: <unknown function> + 0xc9039 (0x7ff8b8a91039 in /home/junchen/miniconda3/lib/python3.7/site-packages/google/protobuf/pyext/../../../../../libstdc++.so.6)
frame #27: <unknown function> + 0x8609 (0x7ff8c86e9609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #28: clone + 0x43 (0x7ff8c860e163 in /lib/x86_64-linux-gnu/libc.so.6)


On WorkerInfo(id=1, name=worker1):
RuntimeError("Couldn't find autograd context data for current autograd context id\nException raised from currentContext at /opt/conda/conda-bld/pytorch_1639180594101/work/torch/csrc/distributed/autograd/context/container.cpp:178 (most recent call first):\nframe #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff7f11b1d62 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7ff7f11ae75f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #2: torch::distributed::autograd::DistAutogradContainer::currentContext() + 0x16f (0x7ff83a6158df in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #3: torch::distributed::autograd::getMessageWithAutograd(short, c10::intrusive_ptr<torch::distributed::rpc::Message, c10::detail::intrusive_target_default_null_type<torch::distributed::rpc::Message> >, torch::distributed::rpc::MessageType, bool, std::unordered_map<c10::Device, c10::Device, std::hash<c10::Device>, std::equal_to<c10::Device>, std::allocator<std::pair<c10::Device const, c10::Device> > > const&) + 0xf2 (0x7ff83a612742 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #4: <unknown function> + 0x3d465be (0x7ff83a6495be in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #5: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #6: <unknown function> + 0xb56f39 (0x7ff88af93f39 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #7: <unknown function> + 0xef8c0f (0x7ff88b335c0f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #8: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #9: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #10: <unknown function> + 0x3d45f2c (0x7ff83a648f2c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #11: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #12: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #13: torch::distributed::rpc::OwnerRRef::setValue(c10::IValue&&) + 0x34 (0x7ff83a662374 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #14: <unknown function> + 0x3d459b5 (0x7ff83a6489b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #15: torch::distributed::rpc::RequestCallbackNoPython::assignOwnerRRef(torch::distributed::rpc::GloballyUniqueId const&, torch::distributed::rpc::GloballyUniqueId const&, c10::intrusive_ptr<c10::ivalue::Future, c10::detail::intrusive_target_default_null_type<c10::ivalue::Future> >) const + 0x494 (0x7ff83a64cd24 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #16: torch::distributed::rpc::RequestCallbackImpl::processPythonRemoteCall(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0xbc (0x7ff88b331c7c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #17: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x17f (0x7ff83a650c1f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #18: torch::distributed::rpc::RequestCallbackNoPython::processForwardAutogradReq(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x1b0 (0x7ff83a651090 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #19: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x213 (0x7ff83a650cb3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #20: torch::distributed::rpc::RequestCallbackImpl::processRpcWithErrors(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x55 (0x7ff88b3313b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)\nframe #21: <unknown function> + 0x3d479cb (0x7ff83a64a9cb in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #22: torch::distributed::rpc::RequestCallbackNoPython::processMessage(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x4a4 (0x7ff83a64b504 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #23: torch::distributed::rpc::RequestCallback::operator()(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x47 (0x7ff83a6469d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #24: <unknown function> + 0x3d778d7 (0x7ff83a67a8d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)\nframe #25: c10::ThreadPool::main_loop(unsigned long) + 0x283 (0x7ff7f11a29b3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)\nframe #26: <unknown function> + 0xc9039 (0x7ff8b8a91039 in /home/junchen/miniconda3/lib/python3.7/site-packages/google/protobuf/pyext/../../../../../libstdc++.so.6)\nframe #27: <unknown function> + 0x8609 (0x7ff8c86e9609 in /lib/x86_64-linux-gnu/libpthread.so.0)\nframe #28: clone + 0x43 (0x7ff8c860e163 in /lib/x86_64-linux-gnu/libc.so.6)\n")
Traceback (most recent call last):
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/internal.py", line 204, in _run_function
    result = python_udf.func(*python_udf.args, **python_udf.kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/rref_proxy.py", line 9, in _local_invoke
    return getattr(rref.local_value(), func_name)(*args, **kwargs)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 151, in forward
    x1 = x_rref.to_here().to(self.device)
RuntimeError: Couldn't find autograd context data for current autograd context id
Exception raised from currentContext at /opt/conda/conda-bld/pytorch_1639180594101/work/torch/csrc/distributed/autograd/context/container.cpp:178 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x42 (0x7ff7f11b1d62 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, char const*) + 0x5f (0x7ff7f11ae75f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #2: torch::distributed::autograd::DistAutogradContainer::currentContext() + 0x16f (0x7ff83a6158df in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #3: torch::distributed::autograd::getMessageWithAutograd(short, c10::intrusive_ptr<torch::distributed::rpc::Message, c10::detail::intrusive_target_default_null_type<torch::distributed::rpc::Message> >, torch::distributed::rpc::MessageType, bool, std::unordered_map<c10::Device, c10::Device, std::hash<c10::Device>, std::equal_to<c10::Device>, std::allocator<std::pair<c10::Device const, c10::Device> > > const&) + 0xf2 (0x7ff83a612742 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x3d465be (0x7ff83a6495be in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #5: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #6: <unknown function> + 0xb56f39 (0x7ff88af93f39 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0xef8c0f (0x7ff88b335c0f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #8: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #9: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #10: <unknown function> + 0x3d45f2c (0x7ff83a648f2c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #11: void c10::ivalue::Future::invokeCallback<std::function<void (c10::ivalue::Future&)> >(std::function<void (c10::ivalue::Future&)>) + 0x17f (0x7ff88af88bbf in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #12: <unknown function> + 0xef8d82 (0x7ff8377fbd82 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #13: torch::distributed::rpc::OwnerRRef::setValue(c10::IValue&&) + 0x34 (0x7ff83a662374 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x3d459b5 (0x7ff83a6489b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #15: torch::distributed::rpc::RequestCallbackNoPython::assignOwnerRRef(torch::distributed::rpc::GloballyUniqueId const&, torch::distributed::rpc::GloballyUniqueId const&, c10::intrusive_ptr<c10::ivalue::Future, c10::detail::intrusive_target_default_null_type<c10::ivalue::Future> >) const + 0x494 (0x7ff83a64cd24 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #16: torch::distributed::rpc::RequestCallbackImpl::processPythonRemoteCall(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0xbc (0x7ff88b331c7c in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #17: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x17f (0x7ff83a650c1f in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #18: torch::distributed::rpc::RequestCallbackNoPython::processForwardAutogradReq(torch::distributed::rpc::RpcCommandBase&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x1b0 (0x7ff83a651090 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #19: torch::distributed::rpc::RequestCallbackNoPython::processRpc(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x213 (0x7ff83a650cb3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #20: torch::distributed::rpc::RequestCallbackImpl::processRpcWithErrors(torch::distributed::rpc::RpcCommandBase&, torch::distributed::rpc::MessageType const&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x55 (0x7ff88b3313b5 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #21: <unknown function> + 0x3d479cb (0x7ff83a64a9cb in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #22: torch::distributed::rpc::RequestCallbackNoPython::processMessage(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x4a4 (0x7ff83a64b504 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #23: torch::distributed::rpc::RequestCallback::operator()(torch::distributed::rpc::Message&, std::vector<c10::Stream, std::allocator<c10::Stream> >) const + 0x47 (0x7ff83a6469d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #24: <unknown function> + 0x3d778d7 (0x7ff83a67a8d7 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)
frame #25: c10::ThreadPool::main_loop(unsigned long) + 0x283 (0x7ff7f11a29b3 in /home/junchen/miniconda3/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #26: <unknown function> + 0xc9039 (0x7ff8b8a91039 in /home/junchen/miniconda3/lib/python3.7/site-packages/google/protobuf/pyext/../../../../../libstdc++.so.6)
frame #27: <unknown function> + 0x8609 (0x7ff8c86e9609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #28: clone + 0x43 (0x7ff8c860e163 in /lib/x86_64-linux-gnu/libc.so.6)

[W tensorpipe_agent.cpp:681] RPC agent for worker2 encountered error when reading incoming request from master: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:681] RPC agent for worker1 encountered error when reading incoming request from master: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:634] RPC agent for worker2 encountered error when sending response to request #191 to master: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:862] RPC agent for worker2 encountered error when sending outgoing request #105 to master: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:681] RPC agent for worker2 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
Traceback (most recent call last):
  File "main.py", line 555, in <module>
    mp.spawn(run_worker, args=(world_size, 1), nprocs=world_size, join=True)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/multiprocessing/spawn.py", line 230, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/multiprocessing/spawn.py", line 188, in start_processes
    while not context.join():
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/multiprocessing/spawn.py", line 150, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/multiprocessing/spawn.py", line 59, in _wrap
    fn(i, *args)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 377, in run_worker
    run_master(num_split)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 333, in run_master
    output = model(images)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 208, in forward
    return torch.cat(torch.futures.wait_all(out_futures))
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/futures/__init__.py", line 317, in wait_all
    return [fut.wait() for fut in torch._C._collect_all(cast(List[torch._C.Future], futures)).wait()]
ValueError: ValueError: On WorkerInfo(id=1, name=worker1):
ValueError('Expected more than 1 value per channel when training, got input size torch.Size([1, 512, 1, 1])')
Traceback (most recent call last):
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/internal.py", line 204, in _run_function
    result = python_udf.func(*python_udf.args, **python_udf.kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/rref_proxy.py", line 9, in _local_invoke
    return getattr(rref.local_value(), func_name)(*args, **kwargs)
  File "/home/junchen/Resource-Efficient-FL/FL-DIST-clean/tcp_splitted_model/send_split_params/main.py", line 156, in forward
    x1 = self.make_layer2(x1)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torchvision/models/resnet.py", line 129, in forward
    out = self.bn2(out)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/modules/batchnorm.py", line 179, in forward
    self.eps,
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/functional.py", line 2280, in batch_norm
    _verify_batch_size(input.size())
  File "/home/junchen/miniconda3/lib/python3.7/site-packages/torch/nn/functional.py", line 2248, in _verify_batch_size
    raise ValueError("Expected more than 1 value per channel when training, got input size {}".format(size))
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 512, 1, 1])


At:
  /home/junchen/miniconda3/lib/python3.7/site-packages/torch/distributed/rpc/internal.py(218): _handle_exception


